steps:
  # Step 1: Clone the GitHub repository
  - name: 'gcr.io/cloud-builders/git'
    args: ['clone', 'https://github.com/bsuharik/melamenus', '/workspace']

  # Step 2: Build the Docker image
  - name: 'gcr.io/cloud-builders/docker'
    args: ['build', '-t', 'gcr.io/stellar-state-376608/your-app', '.']
  
  # Step 3: Push the Docker image to Google Container Registry
  - name: 'gcr.io/cloud-builders/docker'
    args: ['push', 'gcr.io/stellar-state-376608/your-app']

  # Step 4: SSH into the Compute Engine instance and pull the latest changes
  - name: 'gcr.io/cloud-builders/gcloud'
    args:
      - 'compute'
      - 'ssh'
      - 'weblaravel-vm'
      - '--zone=asia-southeast1-a'
      - '--command="cd /var/www/html && docker-compose pull && docker-compose up -d"'
    # Replace 'your-instance-zone' with your actual instance zone
  
images:
  - 'gcr.io/stellar-state-376608/your-app'
